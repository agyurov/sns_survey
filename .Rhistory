posy = par("usr")[3] - ly*scale.lab
text(xseq,rev(yseq),labels = round(x,rnd),xpd=NA,cex=cex)
text(unique(xseq),rep(posy,ncol(x)),labels = colnames(x),xpd=NA,srt=srt,...)
text(rep(posx,nrow(x)),unique(yseq),labels = rownames(x),xpd=NA,srt=srt,...)
}
plot.matrix2(q8fa3$loadings)
plot.matrix2(q8fa3$loadings,scaling=T)
plot.matrix2(q8fa3$loadings,scaling=.2)
plot.matrix2(q8fa3$loadings,scal3)
plot.matrix2(q8fa3$loadings,scale)
plot.matrix2(q8fa3$loadings,scale=2)
plot.matrix2(q8fa3$loadings,scale=5)
plot.matrix2(q8fa3$loadings,scale=T)
# plot the actual matrix
plot.matrix2 = function(x,rnd=3,srt=45,lty=2,cutoff=NULL,cex=1,scale=F,scale.lab=.03,...){
plot.matrix(round(x),bty="n",col="white",yaxt="n",xaxt="n")
xseq = seq(0,1,len=ncol(x))
xseq = rep(xseq,each=nrow(x))
yseq = seq(0,1,len=nrow(x))
yseq = rep(yseq,ncol(x))
abline(v = (unique(xseq) - 1/(ncol(x)*2))[-1],col="grey",lty=lty)
abline(h = (unique(yseq) - 1/(nrow(x)*2))[-1],col="grey",lty=lty)
if(!is.null(cutoff)){
x[x<cutoff] = 0
}
if(scale){
cex = cex * x/max(x)
}
lx = par("usr")[2] - par("usr")[1]
ly = par("usr")[4] - par("usr")[3]
posx = par("usr")[1] - lx*scale.lab
posy = par("usr")[3] - ly*scale.lab
text(xseq,rev(yseq),labels = round(x,rnd),xpd=NA,cex=cex)
text(unique(xseq),rep(posy,ncol(x)),labels = colnames(x),xpd=NA,srt=srt,...)
text(rep(posx,nrow(x)),unique(yseq),labels = rownames(x),xpd=NA,srt=srt,...)
}
plot.matrix2(q8fa3$loadings,scale=T)
plot.matrix2(q8fa3$loadings,scale=T,cex=2)
install.packages(psych)
install.packages("psych")
library(psych)
?alpha
alpha(q8)
alpha(q8nonanum)
n = 50
a = rpois(n,10)
a
a = runif(n,1,7)
a
c = runif(n,1,7)
n = 50
a = runif(n,1,7)
b = a + rnorm(n)
c = runif(n,1,7)
cor(a,b,c)
cor(cbind(a,b,c))
# chronbach's
set.seed(123)
n = 50
a = runif(n,1,7)
b = a + rnorm(n)
c = runif(n,1,7)
cor(cbind(a,b,c))
dat = round(cbind(a,b,c))
cor(dat)
dat
alpha(dat)
x = rowsum(dat)
x = rowSums(dat)
x
alpha
apply(dat,2,sd)
apply(dat,1,sd)
apply(dat,2,sd)
sd(a)
sd(round(a))
calpha = 3/2*(1 - sum(apply(dat,2,var)/var(x))
calpha = 3/2*(1 - sum(apply(dat,2,var)/var(x)))
calpha
alpha(dat)
ps = alpha(dat)
ps$total$raw_alpha
calpha
ps$total$std.alpha
x2 = rowSums(cor(data))
x2 = rowSums(cor(dat))
calpha2 = 3/2*(1 - sum(apply(dat,2,var)/var(x2)))
calpha2
calpha2 = 3/2*(1 - sum(apply(cor(dat),2,var)/var(x2)))
calpha2
mat
upper.tri(mat)
mat[upper.tri(mat)]
cor(dat)[upper.tri(cor(dat))]
mean(cor(dat)[upper.tri(cor(dat))])
K = mean(cor(dat)[upper.tri(cor(dat))])
r = mean(cor(dat)[upper.tri(cor(dat))])
3*r/(1+2*r)
ps$total$std.alpha
ps
r
x
cor(a,x)
calpha
cor(x,b)
cor(x,c)
ps
cor(x,a)
cor(x,b)
cor(x,c)
sd(x)
sd(a)
sd(round(a))
mean(round(a))
mean(round(b))
mean(round(c))
cor(x,round(a))
cor(x,round(b))
cor(x,round(c))
# chronbach's
set.seed(124)
n = 50
a = runif(n,1,7)
b = a + rnorm(n)
c = runif(n,1,7)
dat = round(cbind(a,b,c))
cor(dat)
alpha(dat)
# # manually
# # raw alpha
# x = rowSums(dat)
# calpha = 3/2*(1 - sum(apply(dat,2,var)/var(x)))
# calpha
#
# # std. alpha
#
# r = mean(cor(dat)[upper.tri(cor(dat))])
#
# 3*r/(1+2*r)
# chronbach's
set.seed(125)
n = 50
a = runif(n,1,7)
b = a + rnorm(n)
c = runif(n,1,7)
dat = round(cbind(a,b,c))
# # manually
# # raw alpha
# x = rowSums(dat)
# calpha = 3/2*(1 - sum(apply(dat,2,var)/var(x)))
# calpha
#
# # std. alpha
#
# r = mean(cor(dat)[upper.tri(cor(dat))])
#
# 3*r/(1+2*r)
cor(dat)
alpha(dat)
c
round(c)
# chronbach's
set.seed(125)
n = 50
a = round(runif(n,1,7))
b = round(a + rnorm(n))
c = round(runif(n,1,7))
dat = round(cbind(a,b,c))
# # manually
# # raw alpha
# x = rowSums(dat)
# calpha = 3/2*(1 - sum(apply(dat,2,var)/var(x)))
# calpha
#
# # std. alpha
#
# r = mean(cor(dat)[upper.tri(cor(dat))])
#
# 3*r/(1+2*r)
cor(dat)
alpha(dat)
cor(a,b)
cor(a,c)
sum(a==b)
sum(a==c)
# main
rm(list = ls())
# .pardefault = par()
wd = getwd()
data_file = "all_data.RData"
source("libraries.R")
source("functions.R")
source("data_prep.R")
source("analysis_q8.R")
source("analysis_q10.R")
source("analysis_q19.R")
source("analysis_q20.R")
source("analysis.R")
source("analysis_alt.R")
# record()
# save.image(paste0(getwd(),"/","all_data.RData"))
# save.image(paste0(getwd(),"/bucket.RData"))
# browseURL(paste('file://', file.path(getwd(),'notes.html'), sep=''))
m8
m8$q20.3_bridge3
m8$q20.3_bridge3
class(m8$q20.3_bridge3)
summary(m8$q20.3_bridge3)
m8$q20.3_bridge3$aliased
m8$q20.3_bridge3
?summary.clm
class(models)
class(models$m2)
class(models$m2$q12.1_lookupclassmate)
models$m2$q12.1_lookupclassmate
?alpha
??psych
?alpha
library(psych)
?alpha
(fk = alpha(q19nonanum))
(fk = alpha(q19nonanum))
(fk = alpha(q19nonanum,check.keys = T))
fk = 1:10
class(fk)
is.vector(fk)
is.vector(q9)
dim(q9)
dim(q2)
is.vector(q2)
fk = q2
dim(q2)
dim(fk)
class(fk)
as.vector(fk)
class(as.vector(fk))
names(as.vector(fk))
class(as.vector(fk)[1])
class(as.vector(fk)[5])
class(as.vector(fk)[1,5])
class(as.vector(fk)[5,1])
invert.scale = function(x,y = NULL){
if(class(x)!= "data.frame"){
x = as.data.frame(x=x)
}
}
fk  = 1:10
fk = invert.scale(fk)
class(fk)
fk
fk = q2
class(fk)
class(fk$q2.1_snsusefreq)
levels(fk)
levels(fk$q2.1_snsusefreq)
levels(fk$q2.1_snsusefreq) = rev(levels(fk$q2.1_snsusefreq))
levels(fk)
levels(fk$q2.1_snsusefreq)
head(fk)
head(q2$q2.1_snsusefreq)
x = q19
do.call(cbind.data.frame,lapply(x,function(x) levels(x) = rev(levels(x))))
y = do.call(cbind.data.frame,lapply(x,function(x) levels(x) = rev(levels(x))))
class(y)
dim(y)
dim(x)
y = do.call(rbind.data.frame,lapply(x,function(x) levels(x) = rev(levels(x))))
dim(y)
y = do.call(cbind.data.frame,lapply(x,function(x) levels(x) = rev(levels(x))))
dim(x)
y = do.call(cbind.data.frame,lapply(q19,function(x) levels(x) = rev(levels(x))))
class()
class(y)
dim(y)
y = lapply(19,function(x) levels(x) = rev(levels(x)))
class(y)
y[[1]]
y[[2]]
str(q19)
levels(q19$q19.1_isel1_B)
y = lapply(19,function(x) levels(x) = rev(levels(x)))
rm(x)
y = lapply(19,function(x) levels(x) = rev(levels(x)))
y[[1]]
length(y)
y
y = lapply(q19,function(x) levels(x) = rev(levels(x)))
y$q19.1_isel1_B
dim(y)
length(y)
y = do.call(lapply(q19,function(x) levels(x) = rev(levels(x))))
y = do.call(cbind.data.frame,lapply(q19,function(x) levels(x) = rev(levels(x))))
dim(y)
y = lapply(q19,function(x) levels(x) = rev(levels(x)))
y$q19.1_isel1_B
y = do.call(cbind.data.frame,lapply(q19,function(x) factor(x,levels=rev(levels(x)))))
dim(y)
head(y)
head(q19)
?factor
q8
y = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,levels=rev(levels(x)))))
dim(q8)
dim(y)
y[1,1:5]
head(y)
head(q8)
fk = factor(q2$q2.1_snsusefreq,levels = rev(levels(q2$q2.1_snsusefreq)))
head(fk)
head(q2$q2.1_snsusefreq)
fk = factor(q2$q2.1_snsusefreq,labels = rev(levels(q2$q2.1_snsusefreq)))
head(fk)
y = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)))))
do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)))))
dim(q8)
str(q8)
y = do.call(cbind.data.frame,lapply(q2,function(x) factor(x,labels=rev(levels(x)))))
y = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)))))
y = do.call(cbind.data.frame,lapply(q19,function(x) factor(x,labels=rev(levels(x)))))
str(q19)
str(y)
head(y)
head(q19)
unique(q8)
unique.data(q8)
?relevel
y = do.call(cbind.data.frame,lapply(q19,function(x) relevel(x,ref=rev(levels(x)))))
levels(x)
y = do.call(cbind.data.frame,lapply(q19,function(x) factor(x,labels=rev(levels(x)))))
head(y)
head(q19)
y = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)))))
lapply(q8,function(x) factor(x,labels=rev(levels(x))))
factor(q8$q8.1_killtime,labels=rev(levels(q8$q8.1_killtime)))
q8$q8.1_killtime
factor(x,labels=rev(levels(x)))
x= q8$q8.2_releasetension
factor(x,labels=rev(levels(x)))
x = q8$q8.3_overcomelone
factor(x,labels=rev(levels(x)))
x = q8$q8.4_browsenoreason
factor(x,labels=rev(levels(x)))
x = q8$q8.5_beentertained
factor(x,labels=rev(levels(x)))
x = q8$q8.6_playgamesfriends
factor(x,labels=rev(levels(x)))
x = q8$q8.7_playgamesstranger
factor(x,labels=rev(levels(x)))
unique(x)
y = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)%in%unique(x)))))
factor(x,labels=rev(levels(x)%in%unique(x)))
levels(x) %in% unique(x)
y = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))))
dim(y)
dim(q8)
head(y)
head(q8)
for(i in NULL){print(i)}
for(i in NULL){print(i)}
class(5)
q8
x = Holzinger
x
x[[1]]
invert.scale = function(x,vars = NULL){
# vars character string of vars to reverse
if(class(x)!= "data.frame"){
x = as.data.frame(x=x)
}
if(is.null(vars)){
out = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))))
}
for(i in vars){
if(class(vars) == "character"){
x[vars] = factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))
}
if(class(vars) == "integer" | class(vars) == "numeric"){
x[,vars] = factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))
}
}
}
x = q8
y = invert.scale(x)
head(x)
head(y)
invert.scale = function(x,vars = NULL){
# vars character string of vars to reverse
if(class(x)!= "data.frame"){
x = as.data.frame(x=x)
}
if(is.null(vars)){
x = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))))
}
for(i in vars){
if(class(vars) == "character"){
x[vars] = factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))
}
if(class(vars) == "integer" | class(vars) == "numeric"){
x[,vars] = factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))
}
}
return(x)
}
y = invert.scale(x)
head(y)
head(x)
y = invert.scale(x,"q8.4_browsenoreason")
y = invert.scale(x,vars="q8.4_browsenoreason")
class("q8.4_browsenoreason")
x = q8
vars = "q8.4_browsenoreason"
if(class(x)!= "data.frame"){
x = as.data.frame(x=x)
}
is.null(vars)
i = vars
class(vars) == "character"
class(vars) == "integer" | class(vars) == "numeric"
x[vars] = factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))
q8["q8.4_browsenoreason"]
invert.scale = function(x,vars = NULL){
# vars character string of vars to reverse
if(class(x)!= "data.frame"){
x = as.data.frame(x=x)
}
if(is.null(vars)){
x = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))))
}
for(i in vars){
if(class(vars) == "character"){
x[i] = factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))
}
if(class(vars) == "integer" | class(vars) == "numeric"){
x[,i] = factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))
}
}
return(x)
}
y = invert.scale(x,vars="q8.4_browsenoreason")
invert.scale = function(x,vars = NULL){
# vars character string of vars to reverse
if(class(x)!= "data.frame"){
x = as.data.frame(x=x)
}
if(is.null(vars)){
x = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))))
}
for(i in vars){
if(class(vars) == "character"){
x[i] = factor(x[i],labels=rev(levels(x[i])[levels(x[i])%in%unique(x[i])]))
}
if(class(vars) == "integer" | class(vars) == "numeric"){
x[,i] = factor(x[,i],labels=rev(levels(x[,i])[levels(x[,i])%in%unique(x[,i])]))
}
}
return(x)
}
y = invert.scale(x,vars="q8.4_browsenoreason")
vars
i
levels(x[i])
class()
x = q8
levels(x[i])
i
names(x)
x[i]
class(x[i])
class(x[,i])
invert.scale = function(x,vars = NULL){
# vars character string of vars to reverse
if(class(x)!= "data.frame"){
x = as.data.frame(x=x)
}
if(is.null(vars)){
x = do.call(cbind.data.frame,lapply(q8,function(x) factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))))
}
for(i in vars){
x[,i] = factor(x[,i],labels=rev(levels(x[,i])[levels(x[,i])%in%unique(x[,i])]))
}
return(x)
}
y = invert.scale(x,vars="q8.4_browsenoreason")
head(y)
head(x)
x = q19
x = q19
y = invert.scale(x)
x = q19
head(invert.scale(x))
head(x)
x = q19
head(invert.scale(x))
head(x)
invert.scale = function(x,vars = NULL){
# vars character string of vars to reverse
if(class(x)!= "data.frame"){
x = as.data.frame(x=x)
}
if(is.null(vars)){
x = do.call(cbind.data.frame,lapply(x,function(x) factor(x,labels=rev(levels(x)[levels(x)%in%unique(x)]))))
}
for(i in vars){
x[,i] = factor(x[,i],labels=rev(levels(x[,i])[levels(x[,i])%in%unique(x[,i])]))
}
return(x)
}
x = q19
head(invert.scale(x))
head(x)
head(invert.scale(x,1:3))
head(x)
